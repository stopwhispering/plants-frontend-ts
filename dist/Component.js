sap.ui.define(["sap/ui/core/UIComponent","plants/ui/model/models","sap/ui/model/json/JSONModel","sap/f/FlexibleColumnLayoutSemanticHelper","plants/ui/model/ModelsHelper","plants/ui/customClasses/MessageUtil","plants/ui/customClasses/Util","./customClasses/Navigation","sap/base/util/UriParameters","sap/f/library"],function(e,t,s,o,i,n,a,r,l,d){function g(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const u=g(i);const m=g(n);const c=g(r);const p=d["LayoutType"];const h=e.extend("plants.ui.Component",{constructor:function t(){e.prototype.constructor.apply(this,arguments);this.imagesRegistry={};this.imagesRegistryClone={};this.imagesPlantsLoaded=new Set;this.oEventsDataClone={};this.oPropertiesDataClone={};this.oPlantsDataClone={};this.oTaxonDataClone={};this.oPropertiesTaxonDataClone={}},metadata:{manifest:"json"},init:function o(){e.prototype.init.call(this);this.setModel(t.createDeviceModel(),"device");m.getInstance(this);c.getInstance(this);var i=new s;i.setSizeLimit(2e3);this.setModel(i,"plants");var n=new s;n.setSizeLimit(5e4);this.setModel(n,"images");var a=new s;a.setSizeLimit(250);this.setModel(a,"untaggedImages");var r=new s;r.setSizeLimit(2e3);this.setModel(r,"taxon");var l=new s;r.setSizeLimit(2e3);this.setModel(l,"keywords");this.setModel(new s,"filterValues");var d=new s;d.setProperty("/PlantsEventsDict",{});this.setModel(d,"events");var g=new s;g.setProperty("/propertiesPlants",{});this.setModel(g,"properties");const p=new s;p.setProperty("/propertiesTaxon",{});this.setModel(p,"propertiesTaxa");var h=u.getInstance(this);h.reloadPlantsFromBackend();h.reloadTaxaFromBackend();h.reloadKeywordProposalsFromBackend();h.reloadTraitCategoryProposalsFromBackend();h.reloadNurserySourceProposalsFromBackend();h.reloadPropertyNamesFromBackend();var y=new s({preview_image:"favourite_image"});this.setModel(y,"status");this.setModel(new s);this.getRouter().initialize();this._requestUntaggedImages()},_requestUntaggedImages:function e(){$.ajax({url:a.getServiceUrl("images/untagged/"),context:this,async:true}).done(this._onReceivingUntaggedImages).fail(u.getInstance().onReceiveErrorGeneric.bind(this,"Plant Untagged Images (GET)"))},_onReceivingUntaggedImages:function e(t,s,o){this._addPhotosToRegistry(t.ImagesCollection);this.resetUntaggedPhotos()},_addPhotosToRegistry:function e(t){t.forEach(e=>{if(!(e.filename in this.imagesRegistry)){this.imagesRegistry[e.filename]=e;this.imagesRegistryClone[e.filename]=a.getClonedObject(e)}})},resetUntaggedPhotos:function e(){const t=Object.entries(this.imagesRegistry).filter(e=>!e[1].plants.length);var s=t.map(e=>e[1]);this.getModel("untaggedImages").setProperty("/ImagesCollection",s)},getHelper:function e(){const t=this.getRootControl();const s=t.byId("idFlexibleColumnLayout");const i=l.fromQuery();const n={defaultTwoColumnLayoutType:p.TwoColumnsMidExpanded,defaultThreeColumnLayoutType:p.ThreeColumnsMidExpanded,mode:i.get("mode"),initialColumnsCount:i.get("initial"),maxColumnsCount:i.get("max")};return o.getInstanceFor(s,n)},getModel:function t(s){return e.prototype.getModel.call(this,s)}});return h});