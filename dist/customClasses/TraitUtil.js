sap.ui.define(["sap/m/MessageToast","sap/ui/model/FilterType","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/base/ManagedObject"],function(t,e,i,a,r){const n=r.extend("plants.ui.customClasses.TraitUtil",{onEditTraitPressRemoveTrait:function t(e){this.applyToFragment("dialogEditTrait",t=>{var e=t.getBindingContext("taxon").getPath();var i=e.substr(0,e.indexOf("/traits/"));var a=t.getModel("taxon");var r=a.getProperty(i);var n=t.getBindingContext("taxon").getObject();var s=r.traits.indexOf(n);r.traits.splice(s,1);a.updateBindings(false);t.close()})},onBtnChangeTraitType:function t(e,i){var a=this._oEditTraitFragment.getBindingContext("taxon").getObject();a.status=e;this.applyToFragment("dialogEditTrait",t=>{t.getModel("taxon").updateBindings(false);t.close()})},onPressTrait:function t(e){var i=e.getSource();var a=i.getBindingContext("taxon").getPath();this.applyToFragment("dialogEditTrait",t=>{t.bindElement({path:a,model:"taxon"});t.openBy(i)})},onPressAddTrait:function e(i){var a=this.byId("newTraitCategory").getSelectedKey();var r=this.byId("newTraitCategory")._getSelectedItemText();var n=this.byId("newTraitTrait").getValue().trim();var s=this.byId("newTraitStatus").getSelectedKey();if(n.length===0){t.show("Enter trait first.");return}var o=this.getView().getBindingContext("taxon").getObject();if(o.trait_categories){var g=o.trait_categories.find(function(t){return t.id.toString()===a});if(g){var d=g.traits.find(function(t){return t.trait===n});if(d){t.show("Trait already assigned.");return}}}if(!o.trait_categories){o.trait_categories=[]}if(!g){g={id:a,category_name:r};o.trait_categories.push(g)}var l={id:undefined,status:s,trait:n};if(g.traits){g.traits.push(l)}else{g.traits=[l]}this.getView().getBindingContext("taxon").getModel().updateBindings(false)},onLiveChangeNewTraitTrait:function t(e){var i=e.getSource();var a=i.getBinding("suggestionItems").aApplicationFilters;var r=this.byId("newTraitCategory").getSelectedKey();if(a.length===0&&!!r){this.TraitUtil._filterNewTraitInputPropopsalsByTraitCategory(r)}},onChangeNewTraitCategory:function t(e){var i=e.getParameter("selectedItem");var a=i.getProperty("key");this.TraitUtil._filterNewTraitInputPropopsalsByTraitCategory(a)},_filterNewTraitInputPropopsalsByTraitCategory:function t(r){var n=[new i({path:"trait_category_id",operator:a.EQ,value1:r})];var s=this.getView().byId("newTraitTrait").getBinding("suggestionItems");s.filter(n,e.Application)}});n.getInstance=function t(){if(!n._instance){n._instance=new n}return n._instance};return n});